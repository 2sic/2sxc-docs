<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  <head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PH2TVNW');</script>
    <!-- End Google Tag Manager -->
    <!-- azing recipe embed resizer -->
    <script src="https://cdn.azing.org/e/1/embed.js"></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>How To Organize your Code in Razor | 2sxc and EAV 10 </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="How To Organize your Code in Razor | 2sxc and EAV 10 ">
    <meta name="generator" content="docfx 2.48.1.0">
    
    <link rel="shortcut icon" href="../../images/logos/v11/favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    <meta property="docfx:newtab" content="true">
  
    <!--
      2dm 2021-03-02 Enable lightboxes on all images using
      https://github.com/roel4ez/docfx-lightbox-plugin
    -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.13/featherlight.min.css" type="text/css" rel="stylesheet">
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../images/logos/v11/2sxc50.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../../specs/index.html" title="Specs">Specs</a>
                      </li>
                      <li>
                          <a href="../../how-to/index.html" title="How To">How To</a>
                      </li>
                      <li>
                          <a href="../../net-code/index.html" title="C# &amp; Razor API">C# &amp; Razor API</a>
                      </li>
                      <li>
                          <a href="../../web-api/index.html" title="Web API">Web API</a>
                      </li>
                      <li>
                          <a href="../../api/dot-net/index.html" title=".net API">.net API</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="HowTo.Razor.OrganizeCode">
<h1 id="how-to-organize-your-code-in-razor">How To Organize your Code in Razor</h1>

<p>In simple scenarios you have some Razor files containing a bit of HTML and some code. As your solution grows, you&#39;ll want to organize your work better to ensure that you can maintain it. 2sxc offers various ways to do this:</p>
<ol>
<li>You can split a razor file into a Template and Code-Behind (requires v11)</li>
<li>Reuse a Partial-View Razor file with RenderTemplate()</li>
<li>You can have a shared razor file which is used as a library (v9)</li>
<li>You can have a shared .cs file as a library</li>
</ol>
<h2 id="splitting-razor-templates-with-code-behind">Splitting Razor Templates with Code-Behind</h2>
<p><em>This is new in 2sxc 11 - you can find a <a class="xref" href="../../specs/cms/templates-razor-code-behind.html">video about this</a> in the specs and <a href="https://2sxc.org/dnn-tutorials/en/razor/reuse410/page">here&#39;s a live demo in the DNN Tutorials</a></em></p>
<p>Just create another file with the identical name as your template file, but with <code>.code.cshtml</code> as the extension. So you&#39;ll then have something like:</p>
<ul>
<li><code>_List View.code.cshtml</code></li>
<li><code>_List View.cshtml</code></li>
</ul>
<p>The <em>code</em> file looks just like a normal razor file, but must inherit from <code>ToSic.Sxc.Dnn.RazorComponentCode</code>. Here&#39;s an example of a <code>_demo.code.cshtml</code>: </p>
<pre><code class="lang-cs">@inherits ToSic.Sxc.Dnn.RazorComponentCode

@functions {
  public string Hello() {
    return &quot;Hello from inner code&quot;;
  }
}

@helper ShowDiv(string message) {
  &lt;div&gt;@message&lt;/div&gt;
}
</code></pre><p>This code is automatically available in the primary file - as an object called <code>Code</code>. Here&#39;s an example <code>_demo.cshtml</code> using the above code:</p>
<pre><code class="lang-html">@inherits ToSic.Sxc.Dnn.RazorComponent

&lt;h1&gt;Demo Code Use&lt;/h1&gt;

&lt;div @Edit.TagToolbar(Content)&gt;
    Something in it: @Code.Hello()
&lt;/div&gt;

@Code.ShowDiv(&quot;test helper!&quot;)
</code></pre><div class="TIP"><h5>Tip</h5><p><em>Why would you do this?</em><br>The main reason is to keep template-html separate from most of the code. 
This is common when designers like to modify the html but don&#39;t like all that programming stuff. </p>
</div>
<p>Note that the code-behind also has same methods/events which are automatically called. These methods can be overriden</p>
<ol>
<li><code>CustomizeData()</code><br>This has the same effect as overriding CustomizeData in the template file</li>
<li><code>CustomizeSearch(Dictionary&lt;string, List&lt;ISearchItem&gt;&gt; searchInfos, IContainer moduleInfo,
         DateTime beginDate)</code><br>           This has the same effect as overriding CustomizeSearch in the template file</li>
<li><code>OnRender()</code><br>This lets you run code before rendering. Typically you would use it to set page headers or similar. Note that it doesn&#39;t output HTML (that&#39;s the responsibility of the main template). </li>
<li><code>OnRendered()</code><br>This lets you run code after rendering. Typically also for setting page headers etc, but possibly you need to wait for values which didn&#39;t exist till you rendered. </li>
</ol>
<div class="TIP"><h5>Tip</h5><p><em>Why would you do this?</em><br>These methods could always be created in the Template file, but it just doesn&#39;t feel right.
A typical <code>CustomizeSearch</code> is very technical and feels scary to people who just want to change the look and feel. </p>
</div>
<h2 id="passing-around-anonymous-objects">Passing Around Anonymous Objects</h2>
<p>One of the advanced things you may want to do is have helper functions looking up multiple things, and returning a complex object like this example in the code-behind:</p>
<pre><code class="lang-cs">@inherits ToSic.Sxc.Dnn.RazorComponentCode

@functions {
  public dynamic Hello() {
    return new { Title = &quot;title&quot;, Message = &quot;msg&quot;};
  }
}
</code></pre><p>Which is used like this</p>
<pre><code class="lang-html">@inherits ToSic.Sxc.Dnn.RazorComponent

&lt;h1&gt;Demo Code Use&lt;/h1&gt;

&lt;div @Edit.TagToolbar(Content)&gt;
  @{
    var hello = Code.Hello();
  }
    Something in it: @hello.Title &lt;br&gt;
&lt;/div&gt;
</code></pre><p>This works and is no big deal, but there are known cases where this breaks, usually with a message like somehing not found on <code>object</code>. The reason is bugs in the .net caching of compiled code, specifically if methods exists in various places with the same name. You can resolve this in 3 ways</p>
<ol>
<li>Restart iis (uncool)</li>
<li>Rename the method (recommended)</li>
<li>Return a typed object instead of untyped. In the above example, change to this:</li>
</ol>
<pre><code class="lang-cs">@inherits ToSic.Sxc.Dnn.RazorComponentCode

@functions {
  public class TitleAndMessage {
    public string Title;
    public string Message;
  }
  public dynamic Hello() {
    return new TitleAndMessage { Title = &quot;title&quot;, Message = &quot;msg&quot;};
  }
}
</code></pre><h2 id="reuse-a-partial-view-with-rendertemplate">Reuse a Partial View with RenderTemplate()</h2>
<p><code>RenderTemplate(...)</code> is a standard asp.net function to render another razor file where you need it. You usually use it to make small component razor files which might just show a button or something, and then call that file. </p>
<ul>
<li>You can find some examples in the <a href="https://2sxc.org/dnn-tutorials/en/razor/reuse110/page">tutorials</a></li>
</ul>
<h2 id="share-a-cshtml-file-as-library">Share a .cshtml File as Library</h2>
<p>When you have a <strong>lot of components</strong> it may be easier to create a library of <code>@helper</code> commands. This library is just a normal <code>.cshtml</code> file - usually in a folder called <code>shared</code> or something, and you can then call these snippets and helpers from all your template files. </p>
<ul>
<li>See <a href="https://2sxc.org/dnn-tutorials/en/razor/reuse210/page">examples in the tutorials</a></li>
</ul>
<h2 id="share-a-cs-file-as-library">Share a .cs File as Library</h2>
<p>If you:</p>
<p>a) need to share code with razor and Webapi
b) don&#39;t need razor specific features like <code>@helper</code></p>
<p>You can create a .cs class file and share this across razor files AND WebAPI files. </p>
<ul>
<li>See <a href="https://2sxc.org/dnn-tutorials/en/razor/reuse320/page">examples in the tutorials</a></li>
</ul>
<div class="IMPORTANT"><h5>Important</h5><p>This requires 2sxc 10.01 to work. </p>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/2sic/2sxc-docs/blob/master/2sxc Docs Generator/net-code/razor/organize-code.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.7.13/featherlight.min.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" src="../../styles/plugin-featherlight.js"></script>
  </body>
</html>
