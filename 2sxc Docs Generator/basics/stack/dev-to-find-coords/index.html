

<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
</head>
<body>
  <h1>SVG test</h1>


<div class="context-box1" style="width: 400px">
  <div class="fancybox-auto" style="width: 100%">
    <svg version="1.1" baseProfile="full" viewBox="0 0 3229 2529" xmlns="http://www.w3.org/2000/svg">
      <image href="../assets/stack-detailed.png" x="0" y="0" height="100%" width="100%"/>
      <rect class="svg-highlight highlight1"/>
      <rect class="svg-highlight highlight2"/>
      <rect class="svg-highlight highlight3"/>
      <rect class="svg-highlight highlight4"/>
      <rect class="svg-highlight highlight5"/>
    </svg>
  </div>
</div>

  <div class="fancybox-auto context-box2" style="width: 100%" id="test-image">
    <svg version="1.1" baseProfile="full" viewBox="0 0 3229 2529" xmlns="http://www.w3.org/2000/svg">
      <image href="../assets/stack-detailed.png" x="0" y="0" height="100%" width="100%"/>
      <rect class="svg-highlight highlight1"/>
      <rect class="svg-highlight highlight2"/>
      <rect class="svg-highlight highlight3"/>
      <rect class="svg-highlight highlight4"/>
      <rect class="svg-highlight highlight5"/>
    </svg>
  </div>

  <style>
    /* .xyz {
      width: 700px;
    } */

    .fancybox-auto svg {
      max-height: 90vh;
    }

    .fancybox-auto {
      cursor:zoom-in;
    }

    .svg-highlight {
      stroke: yellow;
      stroke-width: 50;
      fill: none;
      animation: highlight-bounce 3s linear infinite;
    }
    svg:hover .svg-highlight {
      animation: highlight-bounce 6s linear infinite;
    }

    .context-box1 .highlight1 {
      x: 19%;
      y: 82%;
      width: 64%;
      height: 18%;
    }

    .context-box2 .highlight1 {
      x: 19%;
      y: 82%;
      width: 64%;
      height: 18%;
    }
    @keyframes highlight-bounce {
      0%, 100% { stroke: yellow }
      25%, 75% {stroke: gold }
      50% {stroke: cornsilk }
    }
  </style>

  <script>

    function attachFancybox() {
      var containers = $(".fancybox-auto");
      // add ID if missing
      containers.each(function(i, e) {
        if(!e.id) e.id = 'rndId-' + Math.floor(Math.random() * Math.floor(9999999))

        // check if we need to attach some classes from parent
        var pcls = $(e).parent().attr("class");
        if(pcls) {
          var clsList = pcls.split(' ');
          var contextCls = clsList.find(c => c.startsWith('context'));
          if(contextCls) $(e).addClass(contextCls);
        }
      });
      // attach click
      containers.click(function() {
        showDivWithSvg(this.id);
      });
    } 
    $(attachFancybox);

    function showDivWithSvg(target) {
      var newName = target + '-clone';
      var clone = document.getElementById(newName);
      if(!clone) {
        clone = document.getElementById(target).cloneNode(true);
        clone.id = newName;
        clone.style.width = "95%";
        $(clone).click(function() { $.fancybox.close() })
        document.body.appendChild(clone);
      }
      // var original = document.getElementById(target);
      $.fancybox.open( {
        src: '#' + newName,
        type: 'inline',
      });
    }
  </script>
</body>
</html>